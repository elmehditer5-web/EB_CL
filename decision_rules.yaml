# Complete Decision Rules - Exact 1:1 mapping with original arbre_dec
# Evaluation: First match wins (stop at first matching rule)

config:
  pilot_date: "2025-12-01"
  evaluation_mode: "first_match"

# Global checks (before main tree)
global_checks:
  - order: 1
    name: "multiple_PON_check"
    conditions:
      - field: "multiple_PON"
        op: "=="
        value: true
    action:
      type: "comment_only"
      commentaire: "a envoyer a TAFi_Methodes pb : multiple_PON"
    stop: true

# Main decision tree - exact order matters
rules:
  # PON=16
  - order: 100
    name: "PON16"
    conditions:
      - field: "PON"
        op: "=="
        value: 16
    action:
      type: "comment_only"
      commentaire: "a envoyer a TAFi_Methodes pb : PON16"

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien=1, before_pilot
  - order: 200
    name: "PON32_ASTERIX_1L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: "=="
        value: 1
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP 1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien=1, after_pilot
  - order: 201
    name: "PON32_ASTERIX_1L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: "=="
        value: 1
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien=2
  - order: 202
    name: "PON32_ASTERIX_2L"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: "=="
        value: 2
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 2 liaisons 1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien>2, before_pilot, odd
  - order: 203
    name: "PON32_ASTERIX_GT2_BEFORE_ODD"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: ">"
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: true
      - field: "nb_lien_mod_2"
        op: "=="
        value: 1
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien>2, before_pilot, even
  - order: 204
    name: "PON32_ASTERIX_GT2_BEFORE_EVEN"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: ">"
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: true
      - field: "nb_lien_mod_2"
        op: "=="
        value: 0
    action:
      type: "validate_fo"
      commentaire: "ajout 2 fo 1v32"
      actions: "ajout 2 fo 1v32"
      nb_fibre: 2

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien>2 AND <=4, after_pilot
  - order: 205
    name: "PON32_ASTERIX_3TO4_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: ">"
        value: 2
      - field: "nb_lien"
        op: "<="
        value: 4
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP de toutes les liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien>4, after_pilot, odd
  - order: 206
    name: "PON32_ASTERIX_GT4_AFTER_ODD"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: ">"
        value: 4
      - field: "before_pilot_date"
        op: "=="
        value: false
      - field: "nb_lien_mod_2"
        op: "=="
        value: 1
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII ASTERIX, nb_lien>4, after_pilot, even
  - order: 207
    name: "PON32_ASTERIX_GT4_AFTER_EVEN"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nb_lien"
        op: ">"
        value: 4
      - field: "before_pilot_date"
        op: "=="
        value: false
      - field: "nb_lien_mod_2"
        op: "=="
        value: 0
    action:
      type: "validate_fo"
      commentaire: "ajout 2 fo 1v32"
      actions: "ajout 2 fo 1v32"
      nb_fibre: 2

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien=1, before
  - order: 300
    name: "PON32_SFR_300_1L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: "=="
        value: 1
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien=1, after
  - order: 301
    name: "PON32_SFR_300_1L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: "=="
        value: 1
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien=2, before
  - order: 302
    name: "PON32_SFR_300_2L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: "=="
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 2 liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien=2, after
  - order: 303
    name: "PON32_SFR_300_2L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: "=="
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien=3, before
  - order: 304
    name: "PON32_SFR_300_3L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: "=="
        value: 3
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "comment_only"
      commentaire: "a envoyer chez TAFi_Methode"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien=3, after, swap_possible
  - order: 305
    name: "PON32_SFR_300_3L_AFTER_SWAP"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: "=="
        value: 3
      - field: "before_pilot_date"
        op: "=="
        value: false
      - field: "SWAP_possible"
        op: "=="
        value: true
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 3 liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien=3, after, not swap_possible
  - order: 306
    name: "PON32_SFR_300_3L_AFTER_NO_SWAP"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: "=="
        value: 3
      - field: "before_pilot_date"
        op: "=="
        value: false
      - field: "SWAP_possible"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien>=4, before
  - order: 307
    name: "PON32_SFR_300_GE4L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: ">="
        value: 4
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "comment_only"
      commentaire: "pas de solution : 4 liens nro_pm, PM300, ZMD AMII SFR/Orange, PON32"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=300, nb_lien>=4, after
  - order: 308
    name: "PON32_SFR_300_GE4L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
      - field: "nb_lien"
        op: ">="
        value: 4
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 4 liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=900, nb_lien=1
  - order: 310
    name: "PON32_SFR_900_1L_ERROR"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "900"
      - field: "nb_lien"
        op: "=="
        value: 1
    action:
      type: "error"
      commentaire: "erreur : PM == 900 + nb_lien_nro_PM == 1"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=900, nb_lien=2, before
  - order: 311
    name: "PON32_SFR_900_2L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "900"
      - field: "nb_lien"
        op: "=="
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 2 liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=900, nb_lien=2, after
  - order: 312
    name: "PON32_SFR_900_2L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "900"
      - field: "nb_lien"
        op: "=="
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII SFR/Orange, PM=900, 3<=nb_lien<=4
  - order: 313
    name: "PON32_SFR_900_3TO4L"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "900"
      - field: "nb_lien"
        op: ">="
        value: 3
      - field: "nb_lien"
        op: "<="
        value: 4
    action:
      type: "comment_only"
      commentaire: "a envoyer chez TAFi_Methode"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=900, nb_lien>4
  - order: 314
    name: "PON32_SFR_900_GT4L"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "900"
      - field: "nb_lien"
        op: ">"
        value: 4
    action:
      type: "validate_fo"
      commentaire: "ajout 2 fo 1v32"
      actions: "ajout 2 fo 1v32"
      nb_fibre: 2

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=1
  - order: 320
    name: "PON32_SFR_1000_1L_ERROR"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 1
    action:
      type: "error"
      commentaire: "erreur : PM == 900 + nb_lien_nro_PM == 1"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=2, before
  - order: 321
    name: "PON32_SFR_1000_2L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=2, after
  - order: 322
    name: "PON32_SFR_1000_2L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 2
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 2 liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=3, before
  - order: 323
    name: "PON32_SFR_1000_3L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 3
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "validate_fo"
      commentaire: "ajout 3 fo 1v32"
      actions: "ajout 3 fo 1v32"
      nb_fibre: 3

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=3, after
  - order: 324
    name: "PON32_SFR_1000_3L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 3
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 3 liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=4, before
  - order: 325
    name: "PON32_SFR_1000_4L_BEFORE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 4
      - field: "before_pilot_date"
        op: "=="
        value: true
    action:
      type: "validate_fo"
      commentaire: "ajout 2 fo 1v32"
      actions: "ajout 2 fo 1v32"
      nb_fibre: 2

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=4, after
  - order: 326
    name: "PON32_SFR_1000_4L_AFTER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 4
      - field: "before_pilot_date"
        op: "=="
        value: false
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP des 4 liaisons  1v32 vers 1v64"
      actions: "Swap 1v32 vers 1v64"

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=5
  - order: 327
    name: "PON32_SFR_1000_5L"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 5
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=6
  - order: 328
    name: "PON32_SFR_1000_6L"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 6
    action:
      type: "validate_fo"
      commentaire: "ajout 3 fo 1v32"
      actions: "ajout 3 fo 1v32"
      nb_fibre: 3

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=8
  - order: 329
    name: "PON32_SFR_1000_8L"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: "=="
        value: 8
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=ZMD AMII SFR/Orange, PM=1000, nb_lien=other
  - order: 330
    name: "PON32_SFR_1000_OTHER"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "nb_lien"
        op: ">"
        value: 8
    action:
      type: "comment_only"
      commentaire: "a envoyer chez TAFi_Methode"

  # PON=32, PA=RIP Altitude
  - order: 400
    name: "PON32_RIP_ALTITUDE"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "=="
        value: "RIP Altitude"
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=32, PA=other, even
  - order: 410
    name: "PON32_OTHER_EVEN"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "not_in"
        value: ["ZMD AMII ASTERIX", "ZMD AMII SFR/Orange", "RIP Altitude"]
      - field: "nb_lien_mod_2"
        op: "=="
        value: 0
    action:
      type: "validate_fo"
      commentaire: "ajout 2 fo 1v32"
      actions: "ajout 2 fo 1v32"
      nb_fibre: 2

  # PON=32, PA=other, odd
  - order: 411
    name: "PON32_OTHER_ODD"
    conditions:
      - field: "PON"
        op: "=="
        value: 32
      - field: "PA"
        op: "not_in"
        value: ["ZMD AMII ASTERIX", "ZMD AMII SFR/Orange", "RIP Altitude"]
      - field: "nb_lien_mod_2"
        op: "=="
        value: 1
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v32"
      actions: "ajout 1 fo 1v32"
      nb_fibre: 1

  # PON=64, PA=ZMD AMII SFR/Orange, PM=300
  - order: 500
    name: "PON64_SFR_300"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "300"
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v64"
      actions: "ajout 1 fo 1v64"
      nb_fibre: 1

  # PON=64, PA=ZMD AMII SFR/Orange, PM=900, fibre_en_attente
  - order: 501
    name: "PON64_SFR_900_ATTENTE"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "900"
      - field: "fibre_en_attente"
        op: "=="
        value: true
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v64"
      actions: "ajout 1 fo 1v64"
      nb_fibre: 1

  # PON=64, PA=ZMD AMII SFR/Orange, PM=900, no fibre_en_attente
  - order: 502
    name: "PON64_SFR_900_NO_ATTENTE"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "900"
      - field: "fibre_en_attente"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 2 fo 1v64"
      actions: "ajout 2 fo 1v64"
      nb_fibre: 2

  # PON=64, PA=ZMD AMII SFR/Orange, PM=1000, fibre_en_attente
  - order: 503
    name: "PON64_SFR_1000_ATTENTE"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "fibre_en_attente"
        op: "=="
        value: true
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v64"
      actions: "ajout 1 fo 1v64"
      nb_fibre: 1

  # PON=64, PA=ZMD AMII SFR/Orange, PM=1000, no fibre_en_attente
  - order: 504
    name: "PON64_SFR_1000_NO_ATTENTE"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII SFR/Orange"
      - field: "PM"
        op: "=="
        value: "1000"
      - field: "fibre_en_attente"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 3 fo 1v64"
      actions: "ajout 3 fo 1v64"
      nb_fibre: 3

  # PON=64, PA=ZMD AMII ASTERIX, nom_sfp in annexe, type_liaison=INI, nb_lien=1
  - order: 510
    name: "PON64_ASTERIX_ELIG_INI_1L"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nom_sfp_in_annexe"
        op: "=="
        value: true
      - field: "type_liaison"
        op: "=="
        value: "INI"
      - field: "nb_lien"
        op: "=="
        value: 1
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP de liaison 1v64 vers 1v128"
      actions: "Swap 1v64 vers 1v128"

  # PON=64, PA=ZMD AMII ASTERIX, nom_sfp in annexe, type_liaison=INI, nb_lien!=1
  - order: 511
    name: "PON64_ASTERIX_ELIG_INI_NE1L"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nom_sfp_in_annexe"
        op: "=="
        value: true
      - field: "type_liaison"
        op: "=="
        value: "INI"
      - field: "nb_lien"
        op: "!="
        value: 1
    action:
      type: "validate_swap"
      commentaire: "A lancer en SWAP de liaison 1v64 vers 1v128 et ajout de tiroir 64"
      actions: "Swap 1v64 vers 1v128 + ajout 1 tiroir 64"

  # PON=64, PA=ZMD AMII ASTERIX, nom_sfp in annexe, type_liaison!=INI
  - order: 512
    name: "PON64_ASTERIX_ELIG_NOT_INI"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nom_sfp_in_annexe"
        op: "=="
        value: true
      - field: "type_liaison"
        op: "!="
        value: "INI"
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v64"
      actions: "ajout 1 fo 1v64"
      nb_fibre: 1

  # PON=64, PA=ZMD AMII ASTERIX, nom_sfp not in annexe
  - order: 513
    name: "PON64_ASTERIX_NOT_ELIG"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "=="
        value: "ZMD AMII ASTERIX"
      - field: "nom_sfp_in_annexe"
        op: "=="
        value: false
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v64"
      actions: "ajout 1 fo 1v64"
      nb_fibre: 1

  # PON=64, PA=other
  - order: 520
    name: "PON64_OTHER"
    conditions:
      - field: "PON"
        op: "=="
        value: 64
      - field: "PA"
        op: "not_in"
        value: ["ZMD AMII ASTERIX", "ZMD AMII SFR/Orange"]
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v64"
      actions: "ajout 1 fo 1v64"
      nb_fibre: 1

  # PON=128
  - order: 600
    name: "PON128"
    conditions:
      - field: "PON"
        op: "=="
        value: 128
    action:
      type: "validate_fo"
      commentaire: "ajout 1 fo 1v128"
      actions: "ajout 1 fo 1v128"
      nb_fibre: 1
